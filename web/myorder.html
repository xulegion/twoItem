<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>窝窝团|我的订单</title>
    <link rel="stylesheet" href="css/basic.css" type="text/css" />
    <style>

    </style>
</head>

<body id="index">
<div id="app">
    <div id="headMin">
        <ul class="headConul clearfix">
            <li class="logoLi"> <a gae="click_logo" href="index.html">
                <h1 class="bh logo">窝窝团</h1>
            </a> </li>
            <li class="wowoTitLi"> <a gae="click_slogan" href="#">
                <h2 class="bh wowoTit">精挑细选</h2>
            </a> </li>
            <li class="cityBox">
                <h2 id="cityname" class="cityName">衡阳</h2>
                <span class="cityLink"> 【<a class="Gray5a" href="#" gae="city_list">切换城市</a>】 </span>
                <span id="show_city" class="cityTs"> <b class="triangbor">三角</b> <a id="ipClose" class="closeTs" href="#">关闭</a> 您是不是在 <em id="ipcityname" class="bluec4">衡阳</em> ？点击可选择其他城市 </span> </li>
            <li class="searchLi ">
                <div class="searchlf"> <span class="tri"></span>
                    <div class="hd"> <a class="on deal" href="#">团购</a> <a class="shoper" href="#">商家</a> </div>
                </div>
                <form id="soso_form" method="get" action="">
                    <input class="searchTxt" type="text" autocomplete="off" maxlength="140" name="w" value="请输入商品名、地址">
                    <a id="soso_submit" class="searchBtn" href="#">搜索</a>
                    <input id="sg_from" type="hidden" name="sg_from" value="1">
                    <input id="searchType" type="hidden" name="searchType" value="0">
                </form>
                <div class="hotkey" style="display:block" data-title="data_T"> <a target="_self" href="#">月饼</a> <a class="on" target="_self" href="#">KTV</a> <a target="_self" href="#">蛋糕</a> <a target="_self" href="#">希朵曼</a> <a target="_self" href="#">万达</a> <a target="_self" href="#">水上乐园</a> </div>
                <div class="hotkey" data-title="data_S" style="display: none;"> <a target="_self" href="#">月饼</a> <a class="on" target="_self" href="#">KTV</a> <a target="_self" href="#">蛋糕</a> <a target="_self" href="#">希朵曼</a> <a target="_self" href="#">万达</a> <a target="_self" href="#">水上乐园</a> </div>
                <div class="searchBox">
                    <p class="searchTip">最近搜索过 </p>
                    <ul class="clearfix">
                    </ul>
                </div>
            </li>
            <li id="userPointDiv" class="pointnum"> <b class="triangbor">三角</b> <span class="Gray7"> 积分：<strong id="userPointStrong" class="red21"></strong> </span> </li>
        </ul>
    </div>
    <div id="headNav">
        <ul id="navList" class="navUl clearfix">
            <li class="first_nav" date-nav="index"> <a href="#">团购精选</a> </li>
            <li date-nav="shangcheng"> <a href="#">窝窝商城</a> </li>
            <li class="zIndex2" date-nav="shenbian"> <a href="#">身边</a> </li>
            <li date-nav="meishi"> <a href="#">美食</a> </li>
            <li date-nav="yule"> <a href="#">娱乐</a> </li>
            <li class="zIndex" date-nav="dianying"> <a href="#">电影</a> </li>
            <li date-nav="meirongbaojian"> <a href="#">美容保健</a> </li>
            <li date-nav="shenghuofuwu"> <a href="#">生活服务</a> </li>
            <li date-nav="jiehun"> <a href="#">结婚</a> </li>
            <li date-nav="lvyou"> <a href="#">旅行</a> </li>
            <li date-nav="jiudian"> <a href="#">酒店</a> </li>
            <li date-nav="shangpin"> <a href="#">网购</a> </li>
            <li date-nav="shop"> <a href="#">品牌汇</a> </li>
        </ul>
    </div>
    <div id="order" v-show="isshow">
        <h1>订单详情</h1>
        <form id="orderdetails" method="post" action="aliPay.action">
            <input type="hidden" name="op" value="OpaliPay" />
            <table width="918" cellspacing="0" cellpadding="0" border="0">
                <thead>
                <tr>
                    <th class="first" width="1000" valign="middle">商品详情</th>
                    <th width="100" valign="middle">数量</th>
                    <th width="100" valign="middle">价格</th>

                </tr>
                </thead>
                <tbody>
                <tr v-for="item in orderdetails">
                    <td class="last" valign="middle" height="60" align="center"><span id="name" class="price">{{item.name}}</span>
                        <input type="hidden" name="smallCount" :value=`${item.smallCount}` >
                    </td>
                    <td class="last" valign="middle" height="60" align="center"><span id="num" class="price" style="text-align: center" >{{item.num}}</span>
                        <input type="hidden" name="smallCount" :value=`${item.smallCount}` >
                    </td>
                    <td class="last" valign="middle" height="60" align="center"><span id="price" class="find" style="text-align: center" >{{item.dealprice}}</span>
                        <input type="hidden" name="smallCount" :value=`${item.smallCount}` >
                    </td>

                </tr>
                </tbody>
                <tfoot>
                <tr>
                    <td valign="middle" height="60" colspan="2"></td>
                    <td class="last" valign="middle" align="center" style="color: red;font-weight: normal;">
                        <input class="title redb" type="button" @click="out()" value="确定"/></td>
                </tr>
                <tr>
                    <td colspan="4"></td>
                </tr>
                </tfoot>
            </table>
        </form>
    </div>
    <div id="payprocess">
        <h1>我的订单</h1>
        <form id="orderform" method="post" action="aliPay.action">
            <input type="hidden" name="op" value="OpaliPay" />
            <table width="918" cellspacing="0" cellpadding="0" border="0">
                <thead>
                <tr>
                    <th class="first" width="250" valign="middle">商品编号</th>
                    <th width="100" valign="middle">购买时间</th>
                    <th width="100" valign="middle">查看详情</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="item in myorder">
                    <td class="last" valign="middle" height="60" align="center"><span id="number" class="price">{{item.roid}}</span>
                        <input type="hidden" name="smallCount" :value=`${item.smallCount}` >
                    </td>
                    <td class="last" valign="middle" height="60" align="center"><span id="time" class="price">{{item.ordertime | MyOrdertime(item.ordertime)}}</span>
                        <input type="hidden" name="smallCount" :value=`${item.smallCount}` >
                    </td>
                    <td class="last" valign="middle" height="60" align="center"><span id="find" class="find"></span>
                        <input type="button" name="smallCount" value="详情" @click="detalis(item.roid)"  />
                    </td>
                </tr>
                </tbody>
                <tfoot>
                <tr>
                    <td valign="middle" height="60" colspan="4"><span class="title redb"></span></td>
                </tr>
                <tr>
                    <td colspan="3"></td>
                </tr>
                </tfoot>
            </table>
            <div class="subbox">
<!--                <input type="submit" class="next" value="确认购买"/>-->
                <a id="nextbtn2" class="next" type="next" href="javascript:void(0);" @click="clearAll()">清空订单</a>
                <a id="nextbtn3" class="next" type="next" href="index.html;">继续购物</a>
            </div>
        </form>
        <div class="extime" style="text-align:right;font-size:12px;color:#999;padding-top:20px;">欢迎浏览您的订单记录，如果喜欢请继续购物</div>
    </div>
    <div id="footer">
        <div class="bottom-box clearfix">
            <div class="boul">
                <ul class="boul-list">
                    <li class="li-x">
                        <h2 class="">用户帮助</h2>
                    </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">玩转窝窝</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">常见问题</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">秒杀规则</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">积分规则</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">代金券说明</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">评价说明</a> </li>
                </ul>
                <b class="ico"></b> </div>
            <div class="boul">
                <ul class="boul-list">
                    <li class="li-x">
                        <h2 class="h2-1">获取更新</h2>
                    </li>
                    <li> <a class="bolist-a" href="#" target="_blank">窝窝团新浪微博</a> </li>
                    <li> <a class="bolist-a" href="#" target="_blank">窝窝团腾讯微博</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">手机版下载</a> </li>
                </ul>
                <b class="ico ico2"></b> </div>
            <div class="boul">
                <ul class="boul-list">
                    <li class="li-x">
                        <h2 class="h2-2">商务合作</h2>
                    </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">商家入驻</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">提供团购信息</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">友情链接</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">开放API </a> </li>
                </ul>
                <b class="ico ico3"></b> </div>
            <div class="boul">
                <ul class="boul-list">
                    <li class="li-x">
                        <h2 class="h2-3">公司信息</h2>
                    </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">关于我们</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">媒体报道</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">加入我们</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">隐私声明</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">用户协议</a> </li>
                    <li> <a class="bolist-a" rel="nofollow" href="#">营业执照</a> </li>
                </ul>
                <b class="ico ico4"></b> </div>
            <div class="kefu">
                <div class="kefu-bottom">
                    <h2 class="kh2-0 bh">不满意就退款</h2>
                    <h2 class="kh2-1">24小时客服热线</h2>
                    <h2 class="kh2-2 bh">400-105-5555</h2>
                    <a class="bh kfwwweibo" target="_blank" href="#">窝窝团客服微博</a> </div>
            </div>
        </div>
    </div>
    <div class="footer-btm">
        <div class="footer"> &copy; 2010-2014 55tuan.com 京ICP证100702号 京公海网安备110108000829号&nbsp; <a target="_blank" href="#">营业执照</a> </div>
        <div class="footer">名称：北京窝窝团信息技术有限公司&nbsp;&nbsp;&nbsp;&nbsp;地址 ：北京市海淀区上地信息路18号三层3001&nbsp;&nbsp;&nbsp;&nbsp;电话 ：010-59065200</div>
        <div class="footer">营业执照注册号 ：110108011056221&nbsp;&nbsp;&nbsp;&nbsp;食品流通许可证：SP1101081110124921</div>
        <div class="wowofawu"> <a class="fawu-1" rel="nofollow" href="#">支付宝</a> <a class="fawu-3" rel="nofollow" href="#" target="_blank">可信网站</a> <a class="fawu-5" rel="nofollow" href="#" target="_blank">经营性网站备案信息</a> </div>
    </div>
    <div id="ritfllow"> <a class="gotopBtn" href="#" style="visibility: visible; height: 38px;">top</a>
        <div class="mobileBtn" style="visibility: hidden;">
            <div class="codeImg"> <a gae="click_apr_erweima" target="_blank" href="#"> <img width="116" height="148" src="images/ritcodes0807.png"> </a> </div>
        </div>
        <a class="fee_opin" target="_blank" href="#">意见反馈</a> </div>
    <div id="ritCode">
        <div class="imgbox"> <a gae="click_apr_erweima" target="_blank" href="#"> <img width="108" height="183" src="images/ritcodeb.png"> </a> <a class="cCode" href="#">close</a> </div>
    </div>
</div>

<script src="js/vue.js"></script>
<script src="js/axios.js"></script>
<script type="text/javascript">

    let vm = new Vue({
        el: "#app",
        data: {
            myorder:[],
            isshow:false,
            orderdetails:[],
        },
        methods: {
            //查看详情
            detalis:function(roid){
                var params = new URLSearchParams();
                params.append("op","details");
                params.append("roid",roid);
                axios.post( "order.action",params).then(res=>{
                    if(res.data.code==1){
                        this.isshow=true;
                        this.orderdetails=res.data.obj;
                    }else{
                        alert("查询出错");
                    }
                });
            },
            //鼠标滑出订单详情
            out:function(){
                this.isshow=false;
            },
            //订单记录
            order:function () {
                var params = new URLSearchParams();
                params.append("op","myorder");
                return axios.post( "order.action",params);
            }
        },
        mounted: function () {
            axios.all( [this.order()]).then( axios.spread(function (d1) {
                if(d1.data.code==1){
                    vm.$data.myorder=d1.data.obj;
                }
            }))
        },
        filters: {
            MyOrdertime(orderTime){
                var time=Format(orderTime,"yyyy-MM-dd hh:mm:ss");
                return time;
            }
        }
    });


    function Format(datetime,fmt) {
        if (parseInt(datetime)==datetime) {
            if (datetime.length==10) {
                datetime=parseInt(datetime)*1000;
            } else if(datetime.length==13) {
                datetime=parseInt(datetime);
            }
        }
        datetime=new Date(datetime);
        var o = {
            "M+" : datetime.getMonth()+1,                 //月份
            "d+" : datetime.getDate(),                    //日
            "h+" : datetime.getHours(),                   //小时
            "m+" : datetime.getMinutes(),                 //分
            "s+" : datetime.getSeconds(),                 //秒
            "q+" : Math.floor((datetime.getMonth()+3)/3), //季度
            "S"  : datetime.getMilliseconds()             //毫秒
        };
        if(/(y+)/.test(fmt))
            fmt=fmt.replace(RegExp.$1, (datetime.getFullYear()+"").substr(4 - RegExp.$1.length));
        for(var k in o)
            if(new RegExp("("+ k +")").test(fmt))
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
        return fmt;
    }

</script>

</body>
</html>
